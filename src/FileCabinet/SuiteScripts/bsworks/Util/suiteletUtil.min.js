define(["./bsworksUtil.min","N/ui/serverWidget","N/runtime"],function(e,t,l){function i(l,i,r){null==r&&(r=!1);var a=t.createForm({title:l,hideNavBar:r});return e.isNullOrEmpty(i)||(a.clientScriptModulePath=i),a}function r(l,i,r){var a=null;if(!e.isNullOrEmpty(i.id)){a=i.id;var n="过滤器";e.isNullOrEmpty(i.label)||(n=i.label),l.addFieldGroup({id:a,label:n})}for(var u=i.fields,o=0;o<u.length;o++){var d=u[o];s(l,d,a)}var c="",f=i.buttons;if(null==f||0==f.length)c+=p("custpage_search_button","查&nbsp;&nbsp;询",!0),c+=p("custpage_reset_button","重&nbsp;&nbsp;置",!1),c+=p("custpage_exportexcel_button","&nbsp;&nbsp;导出EXCEL&nbsp;&nbsp;",!1);else for(o=0;o<f.length;o++){var m=f[o],y=m.id,g=m.label,b=0==o;c+=p(y,g,b)}l.addField({id:"custpage_search_button",type:t.FieldType.INLINEHTML,label:" ",container:"custpage_fieldgroup_filter"}).updateBreakType({breakType:t.FieldBreakType.STARTCOL}).defaultValue=c,e.isNullOrEmpty(r)||l.updateDefaultValues(r)}function a(l,i,r){var a="custpage_fieldgroup_"+i.id;l.addFieldGroup({id:a,label:i.label});for(var n=i.fields,u=0;u<n.length;u++){var o=n[u];s(l,o,a)}var d=i.buttons;if(null!=d&&d.length>0){var c="";for(u=0;u<d.length;u++){var f=d[u],m="custpage_"+f.id+"_button",y=f.label,g=0==u;null!=f.primary&&(g=f.primary),c+=p(m,y,g)}e.isNullOrEmpty(c)||(l.addField({id:"custpage_button_"+i.id,type:t.FieldType.INLINEHTML,label:" ",container:a}).updateBreakType({breakType:t.FieldBreakType.STARTCOL}).defaultValue=c)}e.isNullOrEmpty(r)||l.updateDefaultValues(r)}function s(l,i,r){var a=i.id;e.isNullOrEmpty(i.asias)||(a=i.asias);var s={id:a,label:i.label,type:i.type};e.isNullOrEmpty(r)||(s.container=r),e.isNullOrEmpty(i.source)||(s.source=i.source);var n=l.addField(s);if(n.updateBreakType({breakType:t.FieldBreakType.STARTCOL}),e.isNullOrEmpty(i.source)&&null!=i.selectOPtions){var u=i.selectOPtions;if(u.length>0){null!=i.showEmptyItem&&!0!==i.showEmptyItem||n.addSelectOption({value:"",text:"-全部-"});for(var o=0;o<u.length;o++)n.addSelectOption(u[o])}}}function n(t,l){var i="inline";if(e.isNullOrEmpty(l.displayType)||(i=l.displayType),"none"!=i){var r=l.id;e.isNullOrEmpty(l.asias)||(r=l.asias);var a="text";e.isNullOrEmpty(l.type)||(a=l.type),"select"==a&&"inline"==i&&e.isNullOrEmpty(l.source)&&e.isNullOrEmpty(l.selectOPtions)&&(a="text");var s={id:r,label:l.label,type:a};"select"!=a||e.isNullOrEmpty(l.source)||(s.source=l.source);var n=t.addField(s);if("select"==a&&e.isNullOrEmpty(l.source)&&null!=l.selectOPtions){var u=l.selectOPtions;if(u.length>0){n.addSelectOption({value:"",text:"-全部-"});for(var o=0;o<u.length;o++){var d=u[o];n.addSelectOption({value:d.value,text:d.text})}}}"disabled"==i&&n.updateDisplayType({displayType:"entry"}),n.updateDisplayType({displayType:i})}}function u(l,i){var r="";e.isNullOrEmpty(i.customPageScript)||(r=i.customPageScript);var a="custpage_subitem_list";e.isNullOrEmpty(i.id)||(a=i.id);var u="list";e.isNullOrEmpty(i.type)||(u=i.type);var o="";e.isNullOrEmpty(i.label)||(o=i.label);var p=l.addSublist({id:a,type:u,label:o}),c=[];e.isNullOrEmpty(i.buttons)||(c=i.buttons);for(var f=0;f<c.length;f++){var m=c[f],y="custpage_"+m.id+"_button";p.addButton({id:y,label:m.label}),null!=m.primary&&0==m.primary||(0==f||m.primary)&&(r+=';document.getElementById("'+y+'").style= document.getElementById("'+y+'").style + ";background: #0297f5 !important; height:26.2px !important;color:white !important;";')}var g=!1;e.isNullOrEmpty(i.hasCheckbox)||(g=i.hasCheckbox),g&&p.addField({id:"sublist_checkbox",type:"checkbox",label:"选择"});var b=p.addField({id:"sublist_line_num",type:"text",label:"序号"});u==t.SublistType.INLINEEDITOR&&b.updateDisplayType({displayType:"disabled"});var h=i.sublistFields;for(f=0;f<h.length;f++){var v=h[f];n(p,v)}null!=i.hasLineChanged&&1!=i.hasLineChanged||p.addField({id:"sublist_line_changed",type:"checkbox",label:"修改行"}).updateDisplayType({displayType:"entry"});var _=i.formFields;if(null!=_&&_.length>0)for(f=0;f<_.length;f++){var N=_[f];s(l,N,a)}var O=i.formFieldGroups;if(null!=O&&O.length>0)for(f=0;f<O.length;f++){var E=O[f];r+=d(E.id,E.colNum,E.lastColRight,E.collapse)}return null!=i.allowHeaderSort&&0!=i.allowHeaderSort||(r+='var sublistHeader=document.getElementById("custpage_subitem_listheader");if(null!=sublistHeader)for(var children=sublistHeader.children,i=0;i<children.length;i++)children[i].removeAttribute("onclick");'),r+="jQuery(\"#custpage_subitem_list_layer .uir-list-control-bar\").append(\"<div id='bsworksSummaryBar' style='position: absolute;right: 30px;top: 13px;font-weight: bold;font-size: 14px;color: #3d3d3d;'>"+(null==i.summaryContent?"":i.summaryContent)+'</div>");',e.isNullOrEmpty(r)||(l.addField({id:"custpage_page_script",type:"inlinehtml",label:" ",container:a}).defaultValue='<script type="text/javascript">(function () {'+r+"}());</script>"),p}function o(t,l){if(null!=l&&0!=l.length)for(var i=0;i<l.length;i++){var r=l[i];for(var a in r){var s=r[a];"sublist_line_num"==a&&(s=i+1+""),e.isNullOrEmpty(s)||t.setSublistValue({id:a,value:s,line:i})}}}function d(e,t,l,i){var r="var colNum="+t+",lastColRight="+l+',filterFieldsObj=document.getElementById("tr_fg_'+e+'"),filterChildNodes=filterFieldsObj.childNodes;filterFieldsObj.removeChild(filterChildNodes[0]),filterFieldsObj.removeChild(filterChildNodes[filterChildNodes.length-1]);var fieldLength=filterChildNodes.length,rowNum=parseInt(fieldLength/colNum);fieldLength%colNum==0&&rowNum--;for(var index=0,r=1;r<=rowNum&&filterChildNodes.length!=colNum;r++){var newTr=document.createElement("tr");newTr.className="uir-fieldgroup-content";for(var i=0;i<colNum;i++){if(lastColRight&&filterChildNodes.length==colNum+1)for(var x=0;x<colNum-(i+1);x++){var emptyTd=document.createElement("td");newTr.append(emptyTd)}filterChildNodes.length>colNum&&newTr.append(filterChildNodes[colNum])}filterFieldsObj.parentElement.append(newTr)}';if(i);return r}function p(t,l,i,r){var a="margin-top:25px;height:30px;min-width:60px;font-family: Open Sans,Helvetica,sans-serif;font-size: 14px !important;font-weight: 600;cursor: pointer; border-radius:3px;";a+=i?"background: #0297f5 !important;border-color: #125ab2 !important;color:white !important;":"margin-left:35px;background: #fafafa !important;border-color:#b2b2b2 !important;",e.isNullOrEmpty(r)||(a+=r);var s='<input type="button" style="'+a+'"  value="'+l+'" id="'+t+'" name="'+t+'" ';return s+=i?"onmouseover=\"this.style.backgroundColor='#125ab2';\" onmouseout=\"this.style.backgroundColor='#0297f5';\" ":"onmouseover=\"this.style.backgroundColor='#e5e5e5';\" onmouseout=\"this.style.background='#fafafa';\" ",s+="/>",s}function c(e,t,i){l.getCurrentSession().set({name:"bsworks_suitelet_filters_conofig",value:JSON.stringify(e)}),l.getCurrentSession().set({name:"bsworks_suitelet_sublist_conofig",value:JSON.stringify(t)}),l.getCurrentSession().set({name:"bsworks_suitelet_formFields_conofig",value:JSON.stringify(i)})}function f(t,l){var i=!(!e.isNullOrEmpty(t.pageInit)&&"true"!=t.pageInit);if(t.pageInit=i,log.debug("parameters",t),i)t.defaultValues=l;else{if(l=JSON.parse(t.defaultValues),null!=l.custpage_filter_start_date&&null!=l.custpage_filter_end_date){var r=e.handleFilterRangeDate(l.custpage_filter_start_date,l.custpage_filter_end_date);l.custpage_filter_date=r}t.defaultValues=l,null!=l.custpage_page_index&&(t.pageIndex=l.custpage_page_index),null!=l.custpage_page_size&&(t.pageSize=l.custpage_page_size)}return t}if(-1!=l.accountId.indexOf("7336086"))return{doCreateForm:i,doCreateFilter:r,doCreateFormGroup:a,doCreateSublist:u,doSetSublistValues:o,doGetRequestParamters:f,doSetSessionSuiteletConfig:c}});